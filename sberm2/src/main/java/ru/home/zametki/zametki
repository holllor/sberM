1. Задание А: определить пол!
присвоить каждому типу транзакции баллы двух типов мужские и женские
проставить их.
посчитать для мужчин, посчитать суммы для женщин (ж=0,м=1)
-----------------
провести группировку по пользователям (отдельно мужчины, отдельно женщины),  всего пользвоателей 15000 из них Ж=6694 М=5306 неопределенных 3000
предположение 1: мужчин - 1974, женщин - 1326 (всего 50 на 50 вообщем списке) предположение 2: в неопределенном списке их примерно 50/50 (1500+1500)
предположение 3: соотношение неопределено в неизвестном списке.
выбираем ключевые коды мсс(список)
у конкретного польз(неопределен)
---------------------------------------------------------
1)на основе эксельфайла сравнения Ж и М получаем ключевые коэф, с мсс_кодами (таблица: id;mcc_code;koefc;sredn_neopred)
2) используя скрипт группировки мсс кодов
------------------- 
SELECT  t.mcc_code, count(t.mcc_code), round(sum(t.amount)/count(t.mcc_code)) as sredn, sum(t.amount), 
(select mcc_description from tr_mcc_codes where mcc_code = t.mcc_code )
  FROM transactions t
left join customers_gender_train g on  t.customer_id= g.customer_id
  where g.gender is null  and t.customer_id = ? and t.amount <0
  and t.tr_type in (1010,1110,1030,1110,1200,2010,2011,2330,2370,2371,4010,4071,4110,6110,7010,
  7011,7030,7031,7070,7071)
  group by t.mcc_code 
  order by  t.mcc_code
 -------------------------------------
перебираем всех неопределенных пользователей, присваем им ПОЛ и заполняем соотвествующую таблицу opredelCustomer(id_customer;gender)
как определяем: берем первый ключевой мсс_код для конкертного пользов(из выборки его группировки) делим neopred_sredn(этого кода)/1.261(1 допущение) и сравниваем 
с пользоват. средним * на коэф.сум (этого кода) далее если у поль. больше или равно то ставим 1  если меньше то ставим 0 и 
                    переходим к следующему ключевому коду пользователя, повторяем
                    далеей суммируем полученные результаты (пример: 1+0+1+1+0+0/6) получаем среднее значение с точностью до десятых 0.6 - это и есть вероятность
                    если она больше 0.8 ставим 1
                    если ключевых кодов у пользов нет то вызываем функцию рандом и ставим на угад.
в итоге смотрим соотношение м/ж если допущение 1 верно оно должно быть около 1.2


*****************--------------*************************** 
1) Запрос на выборку только женских польз. (итог - список)
2) Запрос на выборку только мужских польз. (итог - список)
3) цикл перебора по списку (посчитать какие тр_тайп встречаются чаще)
у пользователя провести группировку по типу транзакции 
наиболее частов встречающиеся у мужчин
наиболее частов встречающиеся у женщин
провести выборку на данных без пола и проставить пол согласно предъидущим данным
 

